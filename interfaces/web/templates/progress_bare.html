{% extends "base.html" %}

{% block title %}{{Home}} - Ten Week Goal App{% endblock %}

{% block content %}

    <!-- ===== WHAT THE BUSINESS LOGIC GIVES US ===== -->

    <!-- summary dict from get_progress_summary() -->
    <pre>
Summary Stats (from ethica/progress_aggregation.py):
  total_goals: {{ summary.total_goals }}
  complete_goals: {{ summary.complete_goals }}
  in_progress_goals: {{ summary.in_progress_goals }}
  avg_completion_percent: {{ summary.avg_completion_percent }}
  total_actions_matched: {{ summary.total_actions_matched }}
    </pre>

    <p>Total actions in DB: {{ total_actions }}</p>
    <p>Total matches found: {{ total_matches }}</p>

    <hr>

    <!-- ===== LOOP THROUGH ALL PROGRESS OBJECTS ===== -->

    {% for progress in all_progress %}
    <div style="border: 1px solid black; margin: 20px 0; padding: 10px;">

        <h3>Goal: <a href="/goal/{{progress.goal.id}}"> {{ progress.goal.description }}</a></h3>

        <!-- What GoalProgress object provides (from ethica/progress_aggregation.py) -->
        <pre>
GoalProgress properties:
  .total_progress = {{ progress.total_progress }}
  .target = {{ progress.target }}
  .percent = {{ progress.percent }}
  .remaining = {{ progress.remaining }}
  .is_complete = {{ progress.is_complete }}
  .is_overachieved = {{ progress.is_overachieved }}
  .matching_actions_count = {{ progress.matching_actions_count }}
  .unit = "{{ progress.unit }}"
        </pre>

        <!-- Goal object properties (from categoriae/goals.py) -->
        <p><strong>Goal details:</strong></p>
        <ul>
            <li>ID: {{ progress.goal.id }}</li>
            <li>{{ progress.goal.description }}</li>
            <li>Target: {{ progress.goal.measurement_target }} {{ progress.goal.measurement_unit }}</li>
            <li>Start date: {{ progress.goal.start_date }}</li>
            <li>End date: {{ progress.goal.end_date }}</li>
        </ul>

        <!-- Now we make PRESENTATION DECISIONS -->
        <p><strong>Presentation choices we could make:</strong></p>
        <ul>
            <li>Show "{{ progress.total_progress }} / {{ progress.target }}" as text?</li>
            <li>Show percentage: {{ progress.percent }}%?</li>

            <li>
                Draw a progress bar?<br>
                [{% for i in range(10) %}{% if i < (progress.percent / 10)|int %}█{% else %}░{% endif %}{% endfor %}] {{ progress.percent|round(1) }}%
            </li>

            <li>
                Color/symbol by status?{% if progress.is_complete %}✓ Completed {% else %} ○ In Progress{% endif %}
            </li>

            <li>
                Format dates:  
                {% if progress.goal.start_date %}
                    SIMPLE: {{ progress.goal.start_date.strftime('%Y-%m-%d') }}
                    READABLE: {{ progress.goal.start_date.strftime('%B %d, %Y') }}
                {% else %}
                    (no start date)
                {% endif %}

            <li>Show as cards vs list vs table? (layout choice)</li>
        </ul>

    </div>
    {% endfor %}

    {% if not all_progress %}
    <p>No goals found.</p>
    {% endif %}


{% endblock %}
