{% extends "base.html" %}

{% block title %}{{ progress.goal.description }} - Ten Week Goal App{% endblock %}

{% block content %}
<div class="goal-detail">
    <div class="breadcrumb">
        <a href="/">‚Üê Back to Dashboard</a>
    </div>

    <header class="goal-detail-header">
        <h2>{{ progress.goal.description }}</h2>

        {% if progress.target > 0 %}
        <div class="large-progress">
            <div class="progress-circle">
                <svg width="200" height="200">
                    <circle cx="100" cy="100" r="90" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                    <circle cx="100" cy="100" r="90" fill="none"
                            stroke="#4CAF50" stroke-width="10"
                            stroke-dasharray="{{ (progress.percent * 565.48 / 100)|round }} 565.48"
                            transform="rotate(-90 100 100)"/>
                </svg>
                <div class="progress-text">
                    <span class="percent">{{ progress.percent|round(1) }}%</span>
                    <span class="label">Complete</span>
                </div>
            </div>

            <div class="progress-stats">
                <div class="stat-item">
                    <span class="stat-label">Current</span>
                    <span class="stat-value">{{ progress.total_progress|round(1) }} {{ progress.unit }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Target</span>
                    <span class="stat-value">{{ progress.target }} {{ progress.unit }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Remaining</span>
                    <span class="stat-value">{{ progress.remaining|round(1) }} {{ progress.unit }}</span>
                </div>
            </div>
        </div>
        {% endif %}
    </header>

    {% if matches %}
    <section class="actions-section">
        <h3>Matching Actions ({{ matches|length }})</h3>
        <div class="actions-list">
            {% for match in matches %}
            <div class="action-item">
                <div class="action-main">
                    <span class="action-description">{{ match.action.description }}</span>
                    <span class="action-contribution">
                        +{{ match.contribution|round(1) }} {{ progress.unit }}
                    </span>
                </div>
                <div class="action-meta">
                    <span class="action-date">{{ match.action.logtime}}</span>
                    {% if match.confidence %}
                    <span class="action-confidence">Confidence: {{ (match.confidence * 100)|round }}%</span>
                    {% endif %}
                    <span class="action-method">{{ match.assignment_method }}</span>
                </div>
            </div><br>
            {% endfor %}
        </div>
    </section>
    {% else %}
    <div class="empty-state">
        <p>No actions matched to this goal yet.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
