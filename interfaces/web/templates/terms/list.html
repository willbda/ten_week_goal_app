{% extends "base.html" %}

{% block title %}Terms - Ten Week Goal App{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <h2>Planning Terms</h2>
    <a href="/terms/new" style="padding: 10px 20px; background: #4CAF50; color: white; text-decoration: none; border-radius: 4px;">+ New Term</a>
</div>

{% if unassigned_goals %}
<div style="background: #fff3cd; border: 1px solid #ffc107; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
    <h3 style="margin-top: 0;">⚠️ Unassigned Goals ({{ unassigned_goals|length }})</h3>
    <p>These goals aren't assigned to any term:</p>
    <ul>
        {% for goal in unassigned_goals[:5] %}
        <li>{{ goal.description }}</li>
        {% endfor %}
        {% if unassigned_goals|length > 5 %}
        <li><em>... and {{ unassigned_goals|length - 5 }} more</em></li>
        {% endif %}
    </ul>
</div>
{% endif %}

{% if terms_with_status %}
    {% for item in terms_with_status %}
    <div style="border: 1px solid #ddd; padding: 20px; margin: 15px 0; border-radius: 4px; {% if item.status == 'active' %}border-left: 5px solid #4CAF50; background: #f0fff4;{% elif item.status == 'upcoming' %}border-left: 5px solid #2196F3;{% else %}opacity: 0.7;{% endif %}">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h3 style="margin: 0;">Term {{ item.term.term_number }}{% if item.term.theme %}: {{ item.term.theme }}{% endif %}</h3>
                <p style="color: #777; margin: 5px 0;">
                    {{ item.term.start_date.strftime('%B %d, %Y') }} → {{ item.term.end_date.strftime('%B %d, %Y') }}
                </p>
            </div>
            <span style="padding: 5px 15px; background: {% if item.status == 'active' %}#4CAF50{% elif item.status == 'upcoming' %}#2196F3{% else %}#999{% endif %}; color: white; border-radius: 20px; font-size: 0.8em; text-transform: uppercase;">
                {{ item.status }}
            </span>
        </div>

        {% if item.status == 'active' and item.progress_percent is not none %}
        <div style="margin: 10px 0;">
            <div style="width: 100%; height: 8px; background: #eee; border-radius: 4px; overflow: hidden;">
                <div style="height: 100%; background: #4CAF50; width: {{ item.progress_percent }}%;"></div>
            </div>
            <p style="text-align: right; font-size: 0.85em; color: #666; margin: 5px 0;">{{ "%.0f"|format(item.progress_percent) }}% complete</p>
        </div>
        {% endif %}

        <div style="display: flex; gap: 20px; margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;">
            <div>
                <strong>{{ item.committed_goal_count }}</strong> committed goals
            </div>
            {% if item.days_remaining is not none %}
            <div>
                <strong>{{ item.days_remaining }}</strong> days remaining
            </div>
            {% endif %}
        </div>

        <div style="margin-top: 15px;">
            <a href="/terms/{{ item.term.id }}" style="padding: 8px 16px; background: #2196F3; color: white; text-decoration: none; border-radius: 4px;">View Details →</a>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div style="text-align: center; padding: 60px 20px; border: 2px dashed #ddd; border-radius: 4px;">
        <p style="color: #777; font-size: 1.1em;">No terms created yet.</p>
        <a href="/terms/new" style="padding: 12px 24px; background: #4CAF50; color: white; text-decoration: none; border-radius: 4px; display: inline-block; margin-top: 20px;">+ Create First Term</a>
    </div>
{% endif %}
{% endblock %}
